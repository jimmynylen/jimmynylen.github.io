<!DOCTYPE html>
<html lang="sv">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Enhetsomvandlare för fysik, kemi, matematik & IT</title>
    <link rel="icon" type="image/x-icon" href="/favicon.ico">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400&family=Source+Serif+Pro&display=swap"
        rel="stylesheet" />
    <!-- MathJax för LaTeX-uttryck -->
    <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <style>
        :root {
            --bg: #f4f4f4;
            --white: #ffffff;
            --primary: #40534C;
            --dark: #1A3636;
            --text: #644117;
            --subtle: #D6BD98;
            --effect: #677D6A;
            --placeholder: #B9AFA1;
            --textarea: #FCF8F4;
            --extra_effect: #D98E04;
            --extra_primary: #E0A030;
            --extra_red: #A44434;
        }

        ::placeholder {
            color: var(--placeholder);
            opacity: 1;
        }

        html,
        body {
            margin: 0;
            padding: 0;
            background-color: var(--bg);
            text-align: left;
        }

        body {
            font-family: 'Source Serif Pro', serif;
            font-size: 14px;
        }

        p {
            margin-top: 0;
            font-size: 15px;
            color: var(--text);
            background-color: var(--subtle);
            border-radius: 0 0 8px 8px;
            padding: 10px 20px;
            margin-bottom: 15px;
        }

        h1 {
            font-family: 'Poppins', sans-serif;
            margin: 0;
            font-size: 24px;
            color: var(--white);
            background-color: var(--primary);
            border-radius: 8px 8px 0 0;
            padding: 10px 20px;
        }

        .container {
            max-width: 700px;
            background-color: #fff;
            border-radius: 8px;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
            padding: 20px;
            margin: 20px auto;
            position: relative;
        }

        /*.converter-form {}*/

        /* --- Modified layout rules for rows and columns --- */
        .row {
            display: flex;
            margin-bottom: 5px;
            gap: 10px;
        }

        .row>.col {
            /* Two-column rows: each column takes exactly 50% of the row */
            flex: 0 0 50%;
            max-width: calc(50% - 5px);
            box-sizing: border-box;
        }

        /* If a row has only one column (like the "Värde" row), it fills 100% */
        .row>.col:only-child {
            flex: 0 0 100%;
            max-width: 100%;
        }

        /* ----------------------------------------------------- */

        label {
            font-family: monospace;
            font-size: 14px;
            color: var(--dark);
            display: block;
        }

        select,
        input[type="number"],
        input[type="text"] {
            padding: 8px;
            background-color: var(--textarea);
            border: 1px solid var(--effect);
            color: var(--dark);
            border-radius: 5px;
            box-sizing: border-box;
            margin: 5px 0;
            width: 100%;
        }

        #value {
            font-size: 16px;
        }

        button {
            cursor: pointer;
            background-color: var(--dark);
            color: var(--white);
            border: none;
            border-radius: 5px;
            font-size: 16px;
            transition: background-color 0.3s ease;
            width: 100%;
            margin-top: 15px;
            padding: 10px 0;
        }

        button:hover {
            background-color: var(--effect);
        }

        #separator {
            border-top: 1px dashed var(--dark);
            margin: 20px 0;
        }

        #result {
            font-family: 'Poppins', sans-serif;
            color: var(--white);
            font-size: 32px;
            padding: 10px;
            background-color: var(--primary);
            border-radius: 8px;
            text-align: center;
            transition: background-color 0.5s;
            margin-bottom: 0;
        }

        #result_outside {
            border: 1px solid var(--primary);
            padding: 15px;
            border-radius: 8px;
            background-color: var(--effect);
        }

        .error {
            color: #E5004B;
            font-weight: bold;
        }

        .input-error {
            border-color: #E5004B;
            background-color: #FFE6E6;
        }
    </style>
</head>

<body>
    <div class="container">
        <h1>Enhetsomvandlare för fysik, kemi, matematik & IT</h1>
        <p>Här kan du snabbt och enkelt konvertera mellan olika fysik- och matematikenheter. Du kan justera precisionen
            genom att ange önskat antal decimaler i svaret. Det kan absolut finnas buggar då jag förlitat mig på ChatGPT
            i stor utsträckning när det gäller enheter inom fysik och kemi.</p>
        <div class="converter-form">
            <!-- Row 1: Kategori & Antal decimaler -->
            <div class="row">
                <div class="col">
                    <label for="kategori">Välj kategori:</label>
                    <select id="kategori" aria-label="Välj kategori"></select>
                </div>
                <div class="col">
                    <label for="decimals">Antal decimaler:</label>
                    <select id="decimals" aria-label="Välj antal decimaler">
            <option value="0">0</option>
            <option value="1">1</option>
            <option value="2" selected>2</option>
            <option value="3">3</option>
            <option value="4">4</option>
            <option value="5">5</option>
            <option value="6">6</option>
            <option value="7">7</option>
            <option value="8">8</option>
            <option value="9">9</option>
            <option value="10">10</option>
          </select>
                </div>
            </div>

            <!-- Row 2: Från enhet & Till enhet -->
            <div class="row">
                <div class="col">
                    <label for="from">Från enhet:</label>
                    <select id="from" aria-label="Från enhet"></select>
                </div>
                <div class="col">
                    <label for="to">Till enhet:</label>
                    <select id="to" aria-label="Till enhet"></select>
                </div>
            </div>

            <!-- Row 3: Värde (full width) -->
            <div style="margin-top: 5px;">
                <label for="value">Värde:</label>
                <input type="text" id="value" placeholder="Ange värde" aria-label="Ange värde" />
            </div>

            <!-- Knapp -->
            <button id="convertBtn">Omvandla</button>
        </div>

        <hr id="separator" />

        <div id="result_outside" aria-live="polite">
            <p id="result">&#129300;</p>
        </div>
    </div>

    <script>
        /* ==========================================================
       1) KONVERTERINGSDATA – inkluderar nu även de nya kemikategorierna
    ========================================================== */
    const konverteringsdata = {
      "längd": {
        special: false,
        units: {
          "Picometer (pm)": { factor: 1e-12, short: "pm" },
          "Ångström (Å)": { factor: 1e-10, short: "Å" },
          "Nanometer (nm)": { factor: 1e-9, short: "nm" },
          "Mikrometer (µm)": { factor: 1e-6, short: "µm" },
          "Millimeter (mm)": { factor: 1e-3, short: "mm" },
          "Centimeter (cm)": { factor: 0.01, short: "cm" },
          "Decimeter (dm)": { factor: 0.1, short: "dm" },
          "Meter (m)": { factor: 1, short: "m" },
          "Kilometer (km)": { factor: 1e3, short: "km" },
          "Tum (in)": { factor: 0.0254, short: "in" },
          "Fot (ft)": { factor: 0.3048, short: "ft" },
          "Yard (yd)": { factor: 0.9144, short: "yd" },
          "Furlong (fur)": { factor: 201.168, short: "fur" },
          "Engelsk mile (mi)": { factor: 1609.34, short: "mi" },
          "Nautisk mil (NM)": { factor: 1852, short: "NM" },
          "Ljusår (ly)": { factor: 9.4607e15, short: "ly" },
          "Parsec (pc)": { factor: 3.086e16, short: "pc" }
        }
      },
      "area": {
        special: false,
        units: {
          "Kvadratmillimeter (mm²)": { factor: 1e-6, short: "mm²" },
          "Kvadratcentimeter (cm²)": { factor: 1e-4, short: "cm²" },
          "Kvadratdecimeter (dm²)": { factor: 1e-2, short: "dm²" },
          "Kvadratmeter (m²)": { factor: 1, short: "m²" },
          "Kvadrattum (in²)": { factor: 0.00064516, short: "in²" },
          "Kvadratfot (ft²)": { factor: 0.092903, short: "ft²" },
          "Kvadratyard (yd²)": { factor: 0.836127, short: "yd²" },
          "Hektar (ha)": { factor: 1e4, short: "ha" },
          "Acre (ac)": { factor: 4046.86, short: "ac" },
          "Kvarter (qr)": { factor: 4046.856, short: "qr" },
          "Tunnland (tld)": { factor: 4936.5, short: "tld" },
          "Kvadratkilometer (km²)": { factor: 1e6, short: "km²" },
          "Kvadratmile (mi²)": { factor: 2.59e6, short: "mi²" }
        }
      },
      "volym": {
        special: false,
        units: {
          "Kubikmillimeter (mm³)": { factor: 1e-6, short: "mm³" },
          "Milliliter (ml)": { factor: 1e-3, short: "ml" },
          "Centiliter (cl)": { factor: 1e-2, short: "cl" },
          "Deciliter (dl)": { factor: 1e-1, short: "dl" },
          "Kubikcentimeter (cm³)": { factor: 1e-3, short: "cm³" },
          "Liter (L)": { factor: 1, short: "L" },
          "Kubikdecimeter (dm³)": { factor: 1, short: "dm³" },
          "Kubiktum (in³)": { factor: 0.0163871, short: "in³" },
          "Kopp (cup)": { factor: 0.236588, short: "cup" },
          "Pint (pt)": { factor: 0.473176, short: "pt" },
          "Gallons (US) (gal)": { factor: 3.78541, short: "gal" },
          "Kubikfot (ft³)": { factor: 28.3168, short: "ft³" },
          "Barrel (bbl)": { factor: 158.9873, short: "bbl" }
        }
      },
      "procent": {
        special: false,
        units: {
          "Procent (%)": { factor: 10000, short: "%" },
          "Parts per million (ppm)": { factor: 1, short: "ppm" },
          "Parts per billion (ppb)": { factor: 0.001, short: "ppb" }
        }
      },
      "vikt": {
        special: false,
        units: {
          "Grain (gr)": { factor: 6.479891e-5, short: "gr" },
          "Mikrogram (µg)": { factor: 1e-9, short: "µg" },
          "Milligram (mg)": { factor: 1e-6, short: "mg" },
          "Karat (ct)": { factor: 0.0002, short: "ct" },
          "Dekagram (dag)": { factor: 0.01, short: "dag" },
          "Gram (g)": { factor: 1e-3, short: "g" },
          "Uns (oz)": { factor: 0.0283495, short: "oz" },
          "Troy ounce (oz t)": { factor: 0.0311034768, short: "oz t" },
          "Pund (lb)": { factor: 0.453592, short: "lb" },
          "Slug (slug)": { factor: 14.5939, short: "slug" },
          "Stone (st)": { factor: 6.35029, short: "st" },
          "Kilogram (kg)": { factor: 1, short: "kg" },
          "Tonne (ton)": { factor: 1e3, short: "ton" },
          "US ton (US ton)": { factor: 907.185, short: "US ton" },
          "Imperial ton (imp ton)": { factor: 1016.0469, short: "imp ton" }
        }
      },
      "tid": {
        special: false,
        units: {
          "Nanosekund (ns)": { factor: 1e-9, short: "ns" },
          "Mikrosekund (µs)": { factor: 1e-6, short: "µs" },
          "Millisekund (ms)": { factor: 1e-3, short: "ms" },
          "Sekund (s)": { factor: 1, short: "s" },
          "Minut (min)": { factor: 60, short: "min" },
          "Timme (h)": { factor: 3600, short: "h" },
          "Dag (d)": { factor: 86400, short: "d" },
          "Vecka (v)": { factor: 604800, short: "v" },
          "Månad (30 dagar) (mo)": { factor: 2592000, short: "mo" },
          "År (365 dagar) (yr)": { factor: 31536000, short: "yr" },
          "Decennium (decade)": { factor: 315360000, short: "decade" }
        }
      },
      "vinkel": {
        special: true,
        units: {
          "Bågsekund (arcsec)": {
            short: "arcsec",
            toBase: (arcsec) => arcsec * (Math.PI / 648000),
            fromBase: (rad) => rad * (648000 / Math.PI)
          },
          "Bågminut (arcmin)": {
            short: "arcmin",
            toBase: (arcmin) => arcmin * (Math.PI / 10800),
            fromBase: (rad) => rad * (10800 / Math.PI)
          },
          "Grader (°)": {
            short: "°",
            toBase: (deg) => deg * (Math.PI / 180),
            fromBase: (rad) => rad * (180 / Math.PI)
          },
          "Gon (gon)": {
            short: "gon",
            toBase: (gon) => gon * (Math.PI / 200),
            fromBase: (rad) => rad * (200 / Math.PI)
          },
          "Radianer (rad)": {
            short: "rad",
            toBase: (rad) => rad,
            fromBase: (rad) => rad
          },
          "Varv (rev)": {
            short: "rev",
            toBase: (rev) => rev * 2 * Math.PI,
            fromBase: (rad) => rad / (2 * Math.PI)
          }
        }
      },
      "temperatur": {
        special: true,
        units: {
          "Réaumur (°Ré)": {
            short: "°Ré",
            toBase: (re) => (re * 1.25) + 273.15,
            fromBase: (k) => (k - 273.15) / 1.25
          },
          "Celsius (°C)": {
            short: "°C",
            toBase: (c) => c + 273.15,
            fromBase: (k) => k - 273.15
          },
          "Fahrenheit (°F)": {
            short: "°F",
            toBase: (f) => (f - 32) * 5 / 9 + 273.15,
            fromBase: (k) => (k - 273.15) * 9 / 5 + 32
          },
          "Kelvin (K)": {
            short: "K",
            toBase: (k) => k,
            fromBase: (k) => k
          },
          "Rankine (°R)": {
            short: "°R",
            toBase: (r) => (r - 491.67) * 5 / 9 + 273.15,
            fromBase: (k) => (k - 273.15) * 9 / 5 + 491.67
          }
        }
      },
      "hastighet": {
        special: true,
        units: {
          "Fot per sekund (ft/s)": {
            short: "ft/s",
            toBase: (ftps) => ftps * 0.3048,
            fromBase: (mps) => mps / 0.3048
          },
          "Meter per sekund (m/s)": {
            short: "m/s",
            toBase: (mps) => mps,
            fromBase: (mps) => mps
          },
          "Kilometer per timme (km/h)": {
            short: "km/h",
            toBase: (kmh) => kmh / 3.6,
            fromBase: (mps) => mps * 3.6
          },
          "Miles per hour (mph)": {
            short: "mph",
            toBase: (mph) => mph * 0.44704,
            fromBase: (mps) => mps / 0.44704
          },
          "Knop (kn)": {
            short: "kn",
            toBase: (kn) => kn * 0.514444,
            fromBase: (mps) => mps / 0.514444
          },
          "Mach (Ma)": {
            short: "Ma",
            toBase: (ma) => ma * 340.29,
            fromBase: (mps) => mps / 340.29
          },
          "Ljushastigheten (c)": {
            short: "c",
            toBase: (c) => c * 299792458,
            fromBase: (mps) => mps / 299792458
          }
        }
      },
      "acceleration": {
        special: false,
        units: {
          "Gal (Gal)": { factor: 0.01, short: "Gal" },
          "Fot per sekundkvadrat (ft/s²)": { factor: 0.3048, short: "ft/s²" },
          "Meter per sekundkvadrat (m/s²)": { factor: 1, short: "m/s²" },
          "G (jordens grav.)": { factor: 9.80665, short: "G" }
        }
      },
      "kraft": {
        special: false,
        units: {
          "Newton (N)": { factor: 1, short: "N" },
          "Kilonewton (kN)": { factor: 1000, short: "kN" },
          "Kilopond (kp)": { factor: 9.80665, short: "kp" },
          "Pound-force (lbf)": { factor: 4.448222, short: "lbf" }
        }
      },
      "energi": {
        special: false,
        units: {
          "Electronvolt (eV)": { factor: 1.602176634e-19, short: "eV" },
          "erg (erg)": { factor: 1e-7, short: "erg" },
          "Foot-pound (ft·lb)": { factor: 1.355817948, short: "ft·lb" },
          "Kalori (cal)": { factor: 4.184, short: "cal" },
          "Joule (J)": { factor: 1, short: "J" },
          "Kilojoule (kJ)": { factor: 1000, short: "kJ" },
          "British Thermal Unit (BTU)": { factor: 1055.06, short: "BTU" },
          "Kilokalori (kcal)": { factor: 4184, short: "kcal" },
          "Ton kyleffekt (ton)": { factor: 3.517e7, short: "ton kyleffekt" },
          "Watt-timme (Wh)": { factor: 3600, short: "Wh" },
          "Kilowatt-timme (kWh)": { factor: 3.6e6, short: "kWh" }
        }
      },
      "effekt": {
        special: false,
        units: {
          "Watt (W)": { factor: 1, short: "W" },
          "Hästkraft (hk)": { factor: 735.4987, short: "hk" },
          "Horsepower (hp)": { factor: 745.7, short: "hp" },
          "BTU per hour (BTU/h)": { factor: 0.29307107, short: "BTU/h" },
          "Kilowatt (kW)": { factor: 1000, short: "kW" },
          "Megawatt (MW)": { factor: 1e6, short: "MW" }
        }
      },
      "tryck": {
        special: false,
        units: {
          "Pascal (Pa)": { factor: 1, short: "Pa" },
          "Torr (torr)": { factor: 133.322, short: "torr" },
          "Millimeter kvicksilver (mmHg)": { factor: 133.322, short: "mmHg" },
          "Kilopascal (kPa)": { factor: 1000, short: "kPa" },
          "PSI (psi)": { factor: 6894.757, short: "psi" },
          "Bar (bar)": { factor: 1e5, short: "bar" },
          "Atmosfär (atm)": { factor: 101325, short: "atm" },
          "KiloPond per kvadratcentimeter (kp/cm²)": { factor: 98066.5, short: "kp/cm²" }
        }
      },
      "frekvens": {
        special: false,
        units: {
          "Hertz (Hz)": { factor: 1, short: "Hz" },
          "Revolutions per minute (rpm)": { factor: 1 / 60, short: "rpm" },
          "Kilohertz (kHz)": { factor: 1e3, short: "kHz" },
          "Megahertz (MHz)": { factor: 1e6, short: "MHz" },
          "Gigahertz (GHz)": { factor: 1e9, short: "GHz" },
          "Terahertz (THz)": { factor: 1e12, short: "THz" }
        }
      },
      "elektrisk ström": {
        special: false,
        units: {
          "Mikroampere (µA)": { factor: 1e-6, short: "µA" },
          "Milliampere (mA)": { factor: 1e-3, short: "mA" },
          "Ampere (A)": { factor: 1, short: "A" },
          "Kiloampere (kA)": { factor: 1e3, short: "kA" }
        }
      },
      "elektrisk spänning": {
        special: false,
        units: {
          "Mikrovolt (µV)": { factor: 1e-6, short: "µV" },
          "Millivolt (mV)": { factor: 1e-3, short: "mV" },
          "Volt (V)": { factor: 1, short: "V" },
          "Kilovolt (kV)": { factor: 1e3, short: "kV" }
        }
      },
      "elektrisk resistans": {
        special: false,
        units: {
          "Ohm (Ω)": { factor: 1, short: "Ω" },
          "Siemens (S)": { factor: 1, short: "S" },
          "Kiloohm (kΩ)": { factor: 1e3, short: "kΩ" },
          "Megaohm (MΩ)": { factor: 1e6, short: "MΩ" },
          "Gigaohm (GΩ)": { factor: 1e9, short: "GΩ" }
        }
      },
      "elektrisk kapacitans": {
        special: false,
        units: {
          "Picofarad (pF)": { factor: 1e-12, short: "pF" },
          "Nanofarad (nF)": { factor: 1e-9, short: "nF" },
          "Microfarad (µF)": { factor: 1e-6, short: "µF" },
          "Farad (F)": { factor: 1, short: "F" }
        }
      },
      "elektrisk induktans": {
        special: false,
        units: {
          "Microhenry (µH)": { factor: 1e-6, short: "µH" },
          "Millihenry (mH)": { factor: 1e-3, short: "mH" },
          "Henry (H)": { factor: 1, short: "H" }
        }
      },
      "ljusstyrka": {
        special: false,
        units: {
          "Lumen per steradian (lm/sr)": { factor: 1, short: "lm/sr" },
          "Candela (cd)": { factor: 1, short: "cd" }
        }
      },
      "luminans": {
        special: false,
        units: {
          "Foot-lambert (fL)": { factor: 3.426, short: "fL" },
          "Candela per kvadratmeter (cd/m²)": { factor: 1, short: "cd/m²" },
          "Nit (nit)": { factor: 1, short: "nit" },
          "Lambert (L)": { factor: 3183.1, short: "L" },
          "Stilb (sb)": { factor: 10000, short: "sb" }
        }
      },
      "belysningsstyrka": {
        special: false,
        units: {
          "Nox (nox)": { factor: 1e-3, short: "nox" },
          "Lux (lx)": { factor: 1, short: "lx" },
          "Foot-candle (fc)": { factor: 10.7639, short: "fc" },
          "Phot (ph)": { factor: 10000, short: "ph" }
        }
      },
      "magnetisk flux": {
        special: false,
        units: {
          "Maxwell (Mx)": { factor: 1e-8, short: "Mx" },
          "Mikroweber (µWb)": { factor: 1e-6, short: "µWb" },
          "Milliweber (mWb)": { factor: 1e-3, short: "mWb" },
          "Weber (Wb)": { factor: 1, short: "Wb" }
        }
      },
      "magnetisk flödestäthet": {
        special: false,
        units: {
          "Tesla (T)": { factor: 1, short: "T" },
          "Gauss (G)": { factor: 1e-4, short: "G" }
        }
      },
      "flödeshastighet": {
        special: false,
        units: {
          "Gallons per minute (GPM)": { factor: 0.06309, short: "GPM" },
          "Barrels per day (BBL/d)": { factor: 0.00184, short: "BBL/d" },
          "Kubikfot per minut (ft³/min)": { factor: 0.4719, short: "ft³/min" },
          "Liter per sekund (L/s)": { factor: 1, short: "L/s" },
          "Kubikmeter per timme (m³/h)": { factor: 0.27778, short: "m³/h" },
          "Kubikfot per sekund (ft³/s)": { factor: 28.3168, short: "ft³/s" },
          "Kubikmeter per sekund (m³/s)": { factor: 1000, short: "m³/s" }
        }
      },
      "viskositet": {
        special: false,
        units: {
          "Centipoise (cP)": { factor: 1e-3, short: "cP" },
          "Poise (P)": { factor: 0.1, short: "P" },
          "Pascal-second (Pa·s)": { factor: 1, short: "Pa·s" }
        }
      },
      "kinematisk viskositet": {
        special: false,
        units: {
          "Centistokes (cSt)": { factor: 1e-2, short: "cSt" },
          "Stokes (St)": { factor: 1, short: "St" }
        }
      },
      "radioaktivitet": {
        special: false,
        units: {
          "Disintegrations per minute (dpm)": { factor: 1 / 60, short: "dpm" },
          "Disintegrations per second (dps)": { factor: 1, short: "dps" },
          "Becquerel (Bq)": { factor: 1, short: "Bq" },
          "Rutherford (Rd)": { factor: 1e6, short: "Rd" },
          "Curie (Ci)": { factor: 3.7e10, short: "Ci" }
        }
      },
      "strålningsdos": {
        special: false,
        units: {
          "Radiation Absorbed Dose (rad)": { factor: 0.01, short: "rad" },
          "Roentgen Equivalent Man (rem)": { factor: 0.01, short: "rem" },
          "Gray (Gy)": { factor: 1, short: "Gy" },
          "Sievert (Sv)": { factor: 1, short: "Sv" }
        }
      },
      "ph": {
        special: true,
        units: {
          "pH": {
            short: "pH",
            toBase: (value) => Math.pow(10, -value),
            fromBase: (value) => -Math.log10(value)
          },
          "[H+] (mol/L)": {
            short: "[H+]",
            toBase: (value) => value,
            fromBase: (value) => value
          }
        }
      },
      "densitet": {
        special: false,
        units: {
          "Kilogram per kubikmeter (kg/m³)": { factor: 1, short: "kg/m³" },
          "Gram per kubikcentimeter (g/cm³)": { factor: 1000, short: "g/cm³" },
          "Gram per liter (g/L)": { factor: 1, short: "g/L" },
          "Pound per cubic foot (lb/ft³)": { factor: 16.0185, short: "lb/ft³" }
        }
      },
      "normalitet": {
        special: false,
        units: {
          "Normal (N)": { factor: 1, short: "N" },
          "Molar (M)": { factor: 1, short: "M" }
        }
      },
      "substansmängd": {
        special: false,
        units: {
          "Nanomol (nmol)": { factor: 1e-9, short: "nmol" },
          "Mikromol (µmol)": { factor: 1e-6, short: "µmol" },
          "Millimol (mmol)": { factor: 1e-3, short: "mmol" },
          "Mol (mol)": { factor: 1, short: "mol" }
        }
      },
      "koncentration": {
        special: false,
        units: {
          "Molar (M)": { factor: 1, short: "M" },
          "Millimolar (mM)": { factor: 1e-3, short: "mM" },
          "Micromolar (µM)": { factor: 1e-6, short: "µM" },
          "Nanomolar (nM)": { factor: 1e-9, short: "nM" },
          "Picomolar (pM)": { factor: 1e-12, short: "pM" }
        }
      },
      "molmassa": {
        special: false,
        units: {
          "Gram per mol (g/mol)": { factor: 1, short: "g/mol" },
          "Milligram per mol (mg/mol)": { factor: 1e-3, short: "mg/mol" },
          "Kilogram per mol (kg/mol)": { factor: 1e3, short: "kg/mol" }
        }
      },
      "datastorlek": {
        special: false,
        units: {
          "Bit (b)": { factor: 0.125, short: "b" },
          "Kilobit (kb)": { factor: 125, short: "kb" },
          "Megabit (Mb)": { factor: 125000, short: "Mb" },
          "Gigabit (Gb)": { factor: 125000000, short: "Gb" },
          "Terabit (Tb)": { factor: 1.25e11, short: "Tb" },
          "Byte (B)": { factor: 1, short: "B" },
          "Kilobyte (KB)": { factor: 1e3, short: "KB" },
          "Kibibyte (KiB)": { factor: 1024, short: "KiB" },
          "Megabyte (MB)": { factor: 1e6, short: "MB" },
          "Mebibyte (MiB)": { factor: 1048576, short: "MiB" },
          "Gigabyte (GB)": { factor: 1e9, short: "GB" },
          "Gibibyte (GiB)": { factor: 1073741824, short: "GiB" },
          "Terabyte (TB)": { factor: 1e12, short: "TB" },
          "Tebibyte (TiB)": { factor: 1099511627776, short: "TiB" }
        }
      },
      "nätverkshastighet": {
        special: false,
        units: {
          "Bit per sekund (bps)": { factor: 1, short: "bps" },
          "Kilobit per sekund (Kbps)": { factor: 1e3, short: "Kbps" },
          "Megabit per sekund (Mbps)": { factor: 1e6, short: "Mbps" },
          "Gigabit per sekund (Gbps)": { factor: 1e9, short: "Gbps" },
          "Byte per sekund (B/s)": { factor: 8, short: "B/s" },
          "Kilobyte per sekund (KB/s)": { factor: 8e3, short: "KB/s" },
          "Megabyte per sekund (MB/s)": { factor: 8e6, short: "MB/s" },
          "Gigabyte per sekund (GB/s)": { factor: 8e9, short: "GB/s" }
        }
      },
      "talbaser": {
        special: true,
        units: {
          "Binär (bin)": {
            base: 2,
            short: "bin",
            toBase: (val) => parseInt(val, 2),
            fromBase: (n) => n.toString(2)
          },
          "Oktal (oct)": {
            base: 8,
            short: "oct",
            toBase: (val) => parseInt(val, 8),
            fromBase: (n) => n.toString(8)
          },
          "Decimal (dec)": {
            base: 10,
            short: "dec",
            toBase: (val) => parseInt(val, 10),
            fromBase: (n) => n.toString(10)
          },
          "Hexadecimal (hex)": {
            base: 16,
            short: "hex",
            toBase: (val) => parseInt(val, 16),
            fromBase: (n) => n.toString(16).toUpperCase()
          }
        }
      }
    };

    /* ==========================================================
       2) KATEGORIER I ÖNSKAD ORDNING – placera de nya kemikategorierna tillsammans med övriga
       Observera att "procent" nu placeras direkt efter "volym"
    ========================================================== */
    const kategorierIÖnskadOrdning = [
      "längd",
      "area",
      "volym",
      "procent",
      "vikt",
      "tid",
      "vinkel",
      "temperatur",
      "hastighet",
      "acceleration",
      "kraft",
      "energi",
      "effekt",
      "tryck",
      "frekvens",
      "elektrisk ström",
      "elektrisk spänning",
      "elektrisk resistans",
      "elektrisk kapacitans",
      "elektrisk induktans",
      "ljusstyrka",
      "luminans",
      "belysningsstyrka",
      "magnetisk flux",
      "magnetisk flödestäthet",
      "flödeshastighet",
      "viskositet",
      "kinematisk viskositet",
      "radioaktivitet",
      "strålningsdos",
      "densitet",
      "substansmängd",
      "ph",
      "koncentration",
      "normalitet",
      "molmassa",
      "datastorlek",
      "nätverkshastighet",
      "talbaser"
    ];

    /* ==========================================================
       3) unitsOrder – enhetsordning för varje kategori
    ========================================================== */
    const unitsOrder = {
      "längd": [
        "Picometer (pm)",
        "Ångström (Å)",
        "Nanometer (nm)",
        "Mikrometer (µm)",
        "Millimeter (mm)",
        "Centimeter (cm)",
        "Decimeter (dm)",
        "Meter (m)",
        "Kilometer (km)",
        "Tum (in)",
        "Fot (ft)",
        "Yard (yd)",
        "Furlong (fur)",
        "Engelsk mile (mi)",
        "Nautisk mil (NM)",
        "Ljusår (ly)",
        "Parsec (pc)"
      ],
      "area": [
        "Kvadratmillimeter (mm²)",
        "Kvadratcentimeter (cm²)",
        "Kvadratdecimeter (dm²)",
        "Kvadratmeter (m²)",
        "Kvadrattum (in²)",
        "Kvadratfot (ft²)",
        "Kvadratyard (yd²)",
        "Hektar (ha)",
        "Acre (ac)",
        "Kvarter (qr)",
        "Tunnland (tld)",
        "Kvadratkilometer (km²)",
        "Kvadratmile (mi²)"
      ],
      "volym": [
        "Kubikmillimeter (mm³)",
        "Milliliter (ml)",
        "Centiliter (cl)",
        "Deciliter (dl)",
        "Kubikcentimeter (cm³)",
        "Liter (L)",
        "Kubikdecimeter (dm³)",
        "Kubiktum (in³)",
        "Kopp (cup)",
        "Pint (pt)",
        "Gallons (US) (gal)",
        "Kubikfot (ft³)",
        "Barrel (bbl)"
      ],
      "procent": [
        "Procent (%)",
        "Parts per million (ppm)",
        "Parts per billion (ppb)"
      ],
      "vikt": [
        "Grain (gr)",
        "Mikrogram (µg)",
        "Milligram (mg)",
        "Karat (ct)",
        "Dekagram (dag)",
        "Gram (g)",
        "Uns (oz)",
        "Troy ounce (oz t)",
        "Pund (lb)",
        "Slug (slug)",
        "Stone (st)",
        "Kilogram (kg)",
        "Tonne (ton)",
        "US ton (US ton)",
        "Imperial ton (imp ton)"
      ],
      "tid": [
        "Nanosekund (ns)",
        "Mikrosekund (µs)",
        "Millisekund (ms)",
        "Sekund (s)",
        "Minut (min)",
        "Timme (h)",
        "Dag (d)",
        "Vecka (v)",
        "Månad (30 dagar) (mo)",
        "År (365 dagar) (yr)",
        "Decennium (decade)"
      ],
      "vinkel": [
        "Bågsekund (arcsec)",
        "Bågminut (arcmin)",
        "Grader (°)",
        "Gon (gon)",
        "Radianer (rad)",
        "Varv (rev)"
      ],
      "temperatur": [
        "Réaumur (°Ré)",
        "Celsius (°C)",
        "Fahrenheit (°F)",
        "Kelvin (K)",
        "Rankine (°R)"
      ],
      "hastighet": [
        "Fot per sekund (ft/s)",
        "Meter per sekund (m/s)",
        "Kilometer per timme (km/h)",
        "Miles per hour (mph)",
        "Knop (kn)",
        "Mach (Ma)",
        "Ljushastigheten (c)"
      ],
      "acceleration": [
        "Gal (Gal)",
        "Fot per sekundkvadrat (ft/s²)",
        "Meter per sekundkvadrat (m/s²)",
        "G (jordens grav.)"
      ],
      "kraft": [
        "Newton (N)",
        "Kilonewton (kN)",
        "Kilopond (kp)",
        "Pound-force (lbf)"
      ],
      "energi": [
        "Electronvolt (eV)",
        "erg (erg)",
        "Foot-pound (ft·lb)",
        "Kalori (cal)",
        "Joule (J)",
        "Kilojoule (kJ)",
        "British Thermal Unit (BTU)",
        "Kilokalori (kcal)",
        "Ton kyleffekt (ton)",
        "Watt-timme (Wh)",
        "Kilowatt-timme (kWh)"
      ],
      "effekt": [
        "Watt (W)",
        "Hästkraft (hk)",
        "Horsepower (hp)",
        "BTU per hour (BTU/h)",
        "Kilowatt (kW)",
        "Megawatt (MW)"
      ],
      "tryck": [
        "Pascal (Pa)",
        "Torr (torr)",
        "Millimeter kvicksilver (mmHg)",
        "Kilopascal (kPa)",
        "PSI (psi)",
        "Bar (bar)",
        "Atmosfär (atm)",
        "KiloPond per kvadratcentimeter (kp/cm²)"
      ],
      "frekvens": [
        "Hertz (Hz)",
        "Revolutions per minute (rpm)",
        "Kilohertz (kHz)",
        "Megahertz (MHz)",
        "Gigahertz (GHz)",
        "Terahertz (THz)"
      ],
      "elektrisk ström": [
        "Mikroampere (µA)",
        "Milliampere (mA)",
        "Ampere (A)",
        "Kiloampere (kA)"
      ],
      "elektrisk spänning": [
        "Mikrovolt (µV)",
        "Millivolt (mV)",
        "Volt (V)",
        "Kilovolt (kV)"
      ],
      "elektrisk resistans": [
        "Ohm (Ω)",
        "Siemens (S)",
        "Kiloohm (kΩ)",
        "Megaohm (MΩ)",
        "Gigaohm (GΩ)"
      ],
      "elektrisk kapacitans": [
        "Picofarad (pF)",
        "Nanofarad (nF)",
        "Microfarad (µF)",
        "Farad (F)"
      ],
      "elektrisk induktans": [
        "Microhenry (µH)",
        "Millihenry (mH)",
        "Henry (H)"
      ],
      "ljusstyrka": [
        "Lumen per steradian (lm/sr)",
        "Candela (cd)"
      ],
      "luminans": [
        "Foot-lambert (fL)",
        "Candela per kvadratmeter (cd/m²)",
        "Nit (nit)",
        "Lambert (L)",
        "Stilb (sb)"
      ],
      "belysningsstyrka": [
        "Nox (nox)",
        "Lux (lx)",
        "Foot-candle (fc)",
        "Phot (ph)"
      ],
      "magnetisk flux": [
        "Maxwell (Mx)",
        "Mikroweber (µWb)",
        "Milliweber (mWb)",
        "Weber (Wb)"
      ],
      "magnetisk flödestäthet": [
        "Tesla (T)",
        "Gauss (G)"
      ],
      "flödeshastighet": [
        "Liter per sekund (L/s)",
        "Kubikmeter per timme (m³/h)"
      ],
      "viskositet": [
        "Centipoise (cP)",
        "Pascal-second (Pa·s)"
      ],
      "kinematisk viskositet": [
        "Centistokes (cSt)",
        "Stokes (St)"
      ],
      "radioaktivitet": [
        "Disintegrations per minute (dpm)",
        "Disintegrations per second (dps)",
        "Becquerel (Bq)",
        "Rutherford (Rd)",
        "Curie (Ci)"
      ],
      "strålningsdos": [
        "Radiation Absorbed Dose (rad)",
        "Roentgen Equivalent Man (rem)",
        "Gray (Gy)",
        "Sievert (Sv)"
      ],
      "ph": [
        "pH",
        "[H+] (mol/L)"
      ],
      "koncentration": [
        "Molar (M)",
        "Millimolar (mM)",
        "Micromolar (µM)",
        "Nanomolar (nM)",
        "Picomolar (pM)"
      ],
      "molmassa": [
        "Gram per mol (g/mol)",
        "Milligram per mol (mg/mol)",
        "Kilogram per mol (kg/mol)"
      ],
      "datastorlek": [
        "Bit (b)",
        "Kilobit (kb)",
        "Megabit (Mb)",
        "Gigabit (Gb)",
        "Terabit (Tb)",
        "Byte (B)",
        "Kilobyte (KB)",
        "Megabyte (MB)",
        "Gigabyte (GB)",
        "Terabyte (TB)",
        "Kibibyte (KiB)",
        "Mebibyte (MiB)",
        "Gibibyte (GiB)",
        "Tebibyte (TiB)"
      ],
      "nätverkshastighet": [
        "Bit per sekund (bps)",
        "Kilobit per sekund (Kbps)",
        "Megabit per sekund (Mbps)",
        "Gigabit per sekund (Gbps)",
        "Byte per sekund (B/s)",
        "Kilobyte per sekund (KB/s)",
        "Megabyte per sekund (MB/s)",
        "Gigabyte per sekund (GB/s)"
      ],
      "talbaser": [
        "Binär (bin)",
        "Oktal (oct)",
        "Decimal (dec)",
        "Hexadecimal (hex)"
      ]
    };

    /* ==========================================================
       5) DEFAULT UNITS – förvalda enheter per kategori
    ========================================================== */
    const defaultUnits = {
      "längd": {
        from: "Meter (m)",
        to: "Kilometer (km)"
      },
      "area": {
        from: "Kvadratmeter (m²)",
        to: "Kvadratkilometer (km²)"
      },
      "volym": {
        from: "Liter (L)",
        to: "Milliliter (ml)"
      },
      "procent": {
        from: "Procent (%)",
        to: "Parts per million (ppm)"
      },
      "vikt": {
        from: "Kilogram (kg)",
        to: "Gram (g)"
      },
      "tid": {
        from: "Sekund (s)",
        to: "Minut (min)"
      },
      "vinkel": {
        from: "Grader (°)",
        to: "Radianer (rad)"
      },
      "temperatur": {
        from: "Celsius (°C)",
        to: "Fahrenheit (°F)"
      },
      "hastighet": {
        from: "Meter per sekund (m/s)",
        to: "Kilometer per timme (km/h)"
      },
      "acceleration": {
        from: "Meter per sekundkvadrat (m/s²)",
        to: "G (jordens grav.)"
      },
      "kraft": {
        from: "Newton (N)",
        to: "Kilopond (kp)"
      },
      "energi": {
        from: "Joule (J)",
        to: "Kilojoule (kJ)"
      },
      "effekt": {
        from: "Watt (W)",
        to: "Kilowatt (kW)"
      },
      "tryck": {
        from: "Pascal (Pa)",
        to: "Bar (bar)"
      },
      "frekvens": {
        from: "Hertz (Hz)",
        to: "Kilohertz (kHz)"
      },
      "elektrisk ström": {
        from: "Ampere (A)",
        to: "Milliampere (mA)"
      },
      "elektrisk spänning": {
        from: "Volt (V)",
        to: "Kilovolt (kV)"
      },
      "elektrisk resistans": {
        from: "Ohm (Ω)",
        to: "Kiloohm (kΩ)"
      },
      "elektrisk kapacitans": {
        from: "Microfarad (µF)",
        to: "Nanofarad (nF)"
      },
      "elektrisk induktans": {
        from: "Millihenry (mH)",
        to: "Microhenry (µH)"
      },
      "ljusstyrka": {
        from: "Candela (cd)",
        to: "Lumen per steradian (lm/sr)"
      },
      "luminans": {
        from: "Candela per kvadratmeter (cd/m²)",
        to: "Nit (nit)"
      },
      "belysningsstyrka": {
        from: "Lux (lx)",
        to: "Foot-candle (fc)"
      },
      "magnetisk flux": {
        from: "Weber (Wb)",
        to: "Milliweber (mWb)"
      },
      "magnetisk flödestäthet": {
        from: "Tesla (T)",
        to: "Gauss (G)"
      },
      "flödeshastighet": {
        from: "Liter per sekund (L/s)",
        to: "Kubikmeter per timme (m³/h)"
      },
      "viskositet": {
        from: "Centipoise (cP)",
        to: "Pascal-second (Pa·s)"
      },
      "kinematisk viskositet": {
        from: "Centistokes (cSt)",
        to: "Stokes (St)"
      },
      "radioaktivitet": {
        from: "Becquerel (Bq)",
        to: "Curie (Ci)"
      },
      "strålningsdos": {
        from: "Radiation Absorbed Dose (rad)",
        to: "Sievert (Sv)"
      },
      "ph": {
        from: "[H+] (mol/L)",
        to: "pH"
      },
      "koncentration": {
        from: "Molar (M)",
        to: "Millimolar (mM)"
      },
      "molmassa": {
        from: "Gram per mol (g/mol)",
        to: "Milligram per mol (mg/mol)"
      },
      "datastorlek": {
        from: "Byte (B)",
        to: "Kilobyte (KB)"
      },
      "nätverkshastighet": {
        from: "Megabit per sekund (Mbps)",
        to: "Megabyte per sekund (MB/s)"
      },
      "talbaser": {
        from: "Decimal (dec)",
        to: "Hexadecimal (hex)"
      }
    };

    /* ==========================================================
       6) uppdateraEnhetsListor – fyller dropdowns baserat på vald kategori
    ========================================================== */
    function uppdateraEnhetsListor() {
      const kategori = document.getElementById('kategori').value;
      const fromSelect = document.getElementById('from');
      const toSelect = document.getElementById('to');

      fromSelect.innerHTML = '';
      toSelect.innerHTML = '';

      const data = konverteringsdata[kategori];
      let enheter;
      if (unitsOrder[kategori]) {
        enheter = unitsOrder[kategori];
      } else {
        enheter = Object.keys(data.units).sort();
      }

      enheter.forEach((enhetNamn) => {
        if (!data.units[enhetNamn]) return;
        const optionFrom = document.createElement('option');
        optionFrom.value = enhetNamn;
        optionFrom.text = enhetNamn;
        fromSelect.appendChild(optionFrom);

        const optionTo = document.createElement('option');
        optionTo.value = enhetNamn;
        optionTo.text = enhetNamn;
        toSelect.appendChild(optionTo);
      });

      if (defaultUnits.hasOwnProperty(kategori)) {
        const defaults = defaultUnits[kategori];
        for (let i = 0; i < fromSelect.options.length; i++) {
          if (fromSelect.options[i].value === defaults.from) {
            fromSelect.selectedIndex = i;
            break;
          }
        }
        for (let i = 0; i < toSelect.options.length; i++) {
          if (toSelect.options[i].value === defaults.to) {
            toSelect.selectedIndex = i;
            break;
          }
        }
      } else {
        fromSelect.selectedIndex = 0;
        toSelect.selectedIndex = 1;
      }
    }

    /* ==========================================================
       7) omvandla – utför själva omvandlingen, med särskild hantering för exempelvis pH
    ========================================================== */
    function omvandla() {
      const kategori = document.getElementById('kategori').value;
      const valueInput = document.getElementById('value').value.trim();
      const decimals = parseInt(document.getElementById('decimals').value, 10);
      const fromVal = document.getElementById('from').value;
      const toVal = document.getElementById('to').value;
      const resultBox = document.getElementById('result');
      const valueField = document.getElementById('value');

      resultBox.classList.remove('error');
      valueField.classList.remove('input-error');

      const data = konverteringsdata[kategori];
      const fromObj = data.units[fromVal];
      const toObj = data.units[toVal];

      // Hantering för talbaser (ej numeriskt värde)
      if (kategori === "talbaser") {
        if (valueInput === '') {
          resultBox.textContent = 'Vänligen ange ett värde.';
          resultBox.classList.add('error');
          valueField.classList.add('input-error');
          return;
        }
        const n = fromObj.toBase(valueInput);
        if (isNaN(n)) {
          resultBox.textContent = 'Ogiltigt tal för vald bas.';
          resultBox.classList.add('error');
          valueField.classList.add('input-error');
          return;
        }
        const konverterat = toObj.fromBase(n);
        // Visar talet med nedsänkt bas, t.ex. 123<sub>10</sub>
        const resultatText = `${valueInput}<sub>${fromObj.base}</sub> = ${konverterat}<sub>${toObj.base}</sub>`;
        resultBox.innerHTML = resultatText;
        return;
      }

      // Speciell hantering för pH-omvandlare
      if (kategori === "ph") {
        if (valueInput === '') {
          resultBox.textContent = 'Vänligen ange ett värde.';
          resultBox.classList.add('error');
          valueField.classList.add('input-error');
          return;
        }
        const valueNum = parseFloat(valueInput);
        if (isNaN(valueNum)) {
          resultBox.textContent = 'Ange ett giltigt tal.';
          resultBox.classList.add('error');
          valueField.classList.add('input-error');
          return;
        }
        let konverterat;
        try {
          konverterat = toObj.fromBase(fromObj.toBase(valueNum));
        } catch (err) {
          resultBox.textContent = `Fel vid omvandling: ${err.message}`;
          resultBox.classList.add('error');
          return;
        }
        resultBox.innerHTML = `${valueNum} ${fromObj.short} = ${konverterat.toFixed(decimals)} ${toObj.short}`;
        return;
      }

      // Standardhantering för övriga omvandlingar
      if (valueInput === '') {
        resultBox.textContent = 'Vänligen ange ett värde.';
        resultBox.classList.add('error');
        valueField.classList.add('input-error');
        return;
      }

      const value = parseFloat(valueInput);
      if (isNaN(value)) {
        resultBox.textContent = 'Vänligen ange ett giltigt tal.';
        resultBox.classList.add('error');
        valueField.classList.add('input-error');
        return;
      }

      if (kategori === "temperatur") {
        if (toVal === "Kelvin (K)" && value < -273.15) {
          resultBox.textContent = 'Kelvin blir negativt. Kontrollera din indata.';
          resultBox.classList.add('error');
          return;
        }
      }

      if (fromVal === toVal) {
        resultBox.textContent = 'Från- och till-enhet är desamma. Ingen omvandling behövs.';
        return;
      }

      let konverterat;
      try {
        if (data.special === true &&
          typeof fromObj.toBase === 'function' &&
          typeof toObj.fromBase === 'function') {
          konverterat = toObj.fromBase(fromObj.toBase(value));
        }
        else if (kategori === "elektrisk resistans") {
          if (fromVal.includes("(Ω)") && toVal.includes("(S)")) {
            if (value === 0) {
              throw new Error("Ohm kan inte vara 0 när du konverterar till Siemens.");
            }
            konverterat = 1 / value;
          }
          else if (fromVal.includes("(S)") && toVal.includes("(Ω)")) {
            if (value === 0) {
              throw new Error("Siemens kan inte vara 0 när du konverterar till Ohm.");
            }
            konverterat = 1 / value;
          }
          else {
            konverterat = (value * fromObj.factor) / toObj.factor;
          }
        }
        else {
          konverterat = (value * fromObj.factor) / toObj.factor;
        }

        if (!isFinite(konverterat)) {
          throw new Error('Resultatet är för stort eller för litet.');
        }

        const fromShort = fromObj.short;
        const toShort = toObj.short;
        let resultatText;

        if (toVal === "Radianer (rad)") {
          const formaterat = formateraRadianer(konverterat);
          resultatText = `${value} ${fromShort} = ${formaterat} ${toShort}`;
        } else {
          resultatText = `${value} ${fromShort} = ${konverterat.toFixed(decimals)} ${toShort}`;
        }

        resultBox.innerHTML = resultatText;
        if (typeof MathJax !== 'undefined') {
          MathJax.typeset();
        }
      }
      catch (err) {
        resultBox.textContent = `Fel vid omvandling: ${err.message}`;
        resultBox.classList.add('error');
      }
    }

    /* ==========================================================
       8) INIT – lyssnar på händelser och fyller listorna
    ========================================================== */
    window.addEventListener('DOMContentLoaded', () => {
      fyllKategorier();
      uppdateraEnhetsListor();

      document.getElementById('kategori')
        .addEventListener('change', () => {
          uppdateraEnhetsListor();
        });

      document.getElementById('convertBtn')
        .addEventListener('click', omvandla);

      document.getElementById('value')
        .addEventListener('keypress', (e) => {
          if (e.key === 'Enter') {
            omvandla();
          }
        });
    });

    /* ==========================================================
       9) fyllKategorier – fyller dropdown-menyn med kategorier, med anpassade namn för kemikategorier
    ========================================================== */
    function fyllKategorier() {
      const kategoriSelect = document.getElementById('kategori');
      kategoriSelect.innerHTML = '';

      kategorierIÖnskadOrdning.forEach((k, index) => {
        if (konverteringsdata[k]) {
          const opt = document.createElement('option');
          opt.value = k;
          switch (k) {
            case "ph":
              opt.text = "pH-omvandlare";
              break;
            case "procent":
              opt.text = "Procent";
              break;
            case "densitet":
              opt.text = "Densitet";
              break;
            case "normalitet":
              opt.text = "Normalitet";
              break;
            default:
              opt.text = k.charAt(0).toUpperCase() + k.slice(1);
          }
          if (index === 0) {
            opt.selected = true;
          }
          kategoriSelect.appendChild(opt);
        }
      });
    }

    /* ==========================================================
       10) Exakt grader -> radianer (för snygg utskrift med LaTeX vid behov)
    ========================================================== */
    const exactDegreesToRadians = {
      0: '0',
      30: 'π/6',
      45: 'π/4',
      60: 'π/3',
      90: 'π/2',
      180: 'π',
      270: '3π/2',
      360: '2π'
    };

    function formateraRadianer(rad) {
      if (rad === 0) return '0';
      const isNegative = rad < 0;
      const absRad = Math.abs(rad);

      for (const [deg, fraction] of Object.entries(exactDegreesToRadians)) {
        const radianValue = deg * (Math.PI / 180);
        if (Math.abs(absRad - radianValue) < 1e-10) {
          if (fraction.includes('/')) {
            const parts = fraction.split('/');
            const latexFraction = `\\(\\frac{${parts[0]}}{${parts[1]}}\\)`;
            return isNegative ? `- ${latexFraction}` : latexFraction;
          } else {
            const latexExpr = `\\(${fraction}\\)`;
            return isNegative ? `- ${latexExpr}` : latexExpr;
          }
        }
      }
      return isNegative ? `-${absRad}` : `${absRad}`;
    }
    </script>
</body>

</html>