<!DOCTYPE html>
<html lang="sv">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Klassrumstimer</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Poppins:wght@400&display=swap" />
  <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Source+Serif+Pro&display=swap" />
  <style>
    :root {
      --bg: #f4f4f4;
      --white: #ffffff;
      --primary: #40534C;
      --cell_mediumgreen: #3CB371;
      --dark: #1A3636;
      --text: #644117;
      --subtle: #D6BD98;
      --effect: #677D6A;
      --placeholder: #B9AFA1;
      --textarea: #FCF8F4;
      --extra_effect: #D98E04;
      --extra_primary: #E0A030;
      --extra_red: #A44434;
      --status_graygreen: #8E9775;
      --status_olivegreen: #5B7052;
      --status_ochreyellow: #D4A76A;
      --status_goldenbrown: #C2955C;
      --status_sienna: #A0522D;
      --status_burntumber: #8A3324;
      --status_steelblue: #4682B4;
      --status_darkblue:  #2C3E50;
      --status_softlavendel: #A7A0C9;
      --status_mutedpurple:  #6B5876;
      
      /* Klockans färger */
      --clock-border: #1A3636;
      --clock-bg: #FCF8F4;
      --clock-digit: #1A3636;
      --clock-hand: #2C3E50;
      --clock-second-hand: #A44434;
      --clock-border-width: 0.05; /* Tjocklek som en andel av radien */
    }
    
    * { box-sizing: border-box; }
    
    body {
      font-family: 'Source Serif Pro', serif;
      margin: 0;
      padding: 0;
      background-color: var(--bg);
    }
    
    .container {
      max-width: 740px;
      margin: 20px auto;
      padding: 20px;
      background-color: var(--white);
      border-radius: 8px;
      box-shadow: 0 0 10px rgba(0,0,0,0.1);
    }
    
    h1 {
      font-family: 'Poppins', sans-serif;
      margin: 0;
      font-size: 24px;
      color: var(--white);
      background-color: var(--primary);
      border-radius: 8px 8px 0 0;
      padding: 10px 20px;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }
    
    .inforuta {
      margin-top: 0;
      font-size: 15px;
      color: var(--text);
      background-color: var(--subtle);
      border-radius: 0 0 8px 8px;
      padding: 10px 20px;
      margin-bottom: 15px;
    }

    /* Timerinställningsruta – placeras under inforutan */
    #timer-settings {
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 10px;
      margin-bottom: 15px;
    }
    #timer-duration {
      width: 80px;
      padding: 5px;
      font-size: 16px;
      text-align: center;
    }
    #timer-buttons button {
      padding: 6px 12px;
      font-size: 16px;
      background-color: var(--effect);
      color: var(--white);
      border: none;
      border-radius: 3px;
      cursor: pointer;
    }
    #timer-buttons button:hover {
      background-color: var(--effect);
    }
    
    .game-area {
      display: flex;
      gap: 15px;
      background-color: var(--effect);
      padding: 15px;
      border-radius: 8px;
      margin-bottom: 15px;
      border: 1px solid var(--primary);
    }
    
    .box {
      flex: 1 1 50%;
      background-color: var(--primary);
      border-radius: 8px;
      padding: 20px;
      text-align: center;
      color: var(--dark);
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      position: relative;
    }
    
    /* Timercirkeldiagram med centrerat (read-only) tidvärde */
    #timer-container {
      position: relative;
      width: 250px;
      height: 250px;
      margin: 0 auto;
    }
    
    #timer-canvas {
      display: block;
      margin: 0 auto;
    }
    
    #timer-content {
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      text-align: center;
    }
    #timer-display {
      font-size: 32px;
      color: var(--dark);
    }
    
    /* Analog klocka */
    #clock-box {
      display: flex;
      justify-content: center;
      align-items: center;
    }
    #clock-box canvas {
      display: block;
      width: 250px;
      height: 250px;
    }
    
    #add-info-btn {
      display: block;
      width: 200px;
      margin: 0 auto 15px auto;
      padding: 10px 20px;
      font-size: 16px;
      background-color: var(--primary);
      color: var(--white);
      border: none;
      border-radius: 5px;
      cursor: pointer;
    }
    #add-info-btn:hover {
      background-color: var(--effect);
    }
  </style>
</head>
<body>
  <div class="container">
    <h1>Klassrumstimer</h1>
    <!-- Inforutan återställd till originaltexten -->
    <p class="inforuta">
      En enkel timer och klocka för visning på projektor under lektioner. Det är också möjligt att visa annan information som kan vara viktig för lektionen eller provet, såsom provkoder till digitala plattformar eller instruktioner för den pågående uppgiften. 
    </p>
  
    <!-- Timerinställningsruta: vanligt nummerfält med knappar på samma rad -->
    <div id="timer-settings">
      <label for="timer-duration">Minuter:</label>
      <input id="timer-duration" type="number" value="30" min="1" />
      <div id="timer-buttons">
        <button id="timer-start-pause">Start/Pausa</button>
        <button id="timer-stop">Stopp</button>
      </div>
    </div>
    
    <div class="game-area">
      <div id="timer-box" class="box">
        <div id="timer-container">
          <canvas id="timer-canvas" width="250" height="250"></canvas>
          <div id="timer-content">
            <span id="timer-display">30:00</span>
          </div>
        </div>
      </div>
      <div id="clock-box" class="box">
        <canvas id="clock-canvas" width="250" height="250"></canvas>
      </div>
    </div>
    
    <button id="add-info-btn">Lägg till ny ruta</button>
    <div id="info-container"></div>
  </div>
  
  <script>
    /* --- TIMER-FUNKTIONALITET --- */
    let timerDuration = parseInt(document.getElementById("timer-duration").value, 10) * 60;
    let timeLeft = timerDuration;
    let timerInterval = null;
    let isTimerRunning = false;
    
    function formatTime(totalSeconds) {
      const minutes = Math.floor(totalSeconds / 60);
      const seconds = totalSeconds % 60;
      return (minutes < 10 ? "0" + minutes : minutes) + ":" +
             (seconds < 10 ? "0" + seconds : seconds);
    }
    
    function updateTimerDisplay() {
      document.getElementById("timer-display").textContent = formatTime(timeLeft);
      updateTimerCanvas();
    }
    
    document.getElementById("timer-start-pause").addEventListener("click", function() {
      if (isTimerRunning) {
        clearInterval(timerInterval);
        isTimerRunning = false;
        this.textContent = "Start/Pausa";
      } else {
        timerInterval = setInterval(function() {
          if (timeLeft > 0) {
            timeLeft--;
            updateTimerDisplay();
          } else {
            clearInterval(timerInterval);
            isTimerRunning = false;
          }
        }, 1000);
        isTimerRunning = true;
        this.textContent = "Start/Pausa";
      }
    });
    
    document.getElementById("timer-stop").addEventListener("click", function() {
      clearInterval(timerInterval);
      isTimerRunning = false;
      timeLeft = timerDuration;
      updateTimerDisplay();
    });
    
    document.getElementById("timer-duration").addEventListener("blur", function() {
      const value = parseInt(this.value, 10);
      if (!isNaN(value) && value > 0) {
        timerDuration = value * 60;
        timeLeft = timerDuration;
        updateTimerDisplay();
      } else {
        this.value = timerDuration / 60;
      }
    });
    
    updateTimerDisplay();
    
    // Rita timerns cirkeldiagram med samma dimensioner och ram tjocklek som klockan
    function updateTimerCanvas() {
      const canvas = document.getElementById("timer-canvas");
      const ctx = canvas.getContext("2d");
      const centerX = canvas.width / 2;
      const centerY = canvas.height / 2;
      const x = centerX;
      const y = centerY;
      const radius = Math.min(x, y) * 0.90;
      
      const rootStyles = getComputedStyle(document.documentElement);
      const timerBg = rootStyles.getPropertyValue('--clock-bg').trim();
      const timerBorder = rootStyles.getPropertyValue('--clock-border').trim();
      const borderRatio = parseFloat(rootStyles.getPropertyValue('--clock-border-width')) || 0.05;
      const borderThickness = radius * borderRatio;
      
      ctx.clearRect(0, 0, canvas.width, canvas.height);
      
      // Bakgrundscirkel
      ctx.beginPath();
      ctx.arc(x, y, radius, 0, 2 * Math.PI);
      ctx.fillStyle = timerBg;
      ctx.fill();
      
      // Framstegs-paj: ifyllt cirkeldiagram
      let progress = (timerDuration - timeLeft) / timerDuration;
      let startAngle = -Math.PI / 2;
      let endAngle = startAngle + progress * 2 * Math.PI;
      ctx.beginPath();
      ctx.moveTo(x, y);
      ctx.arc(x, y, radius, startAngle, endAngle, false);
      ctx.closePath();
      ctx.fillStyle = "#3CB371";
      ctx.fill();
      
      // Rita ramen med samma tjocklek som klockan
      ctx.beginPath();
      ctx.arc(x, y, radius, 0, 2 * Math.PI);
      ctx.strokeStyle = timerBorder;
      ctx.lineWidth = borderThickness;
      ctx.stroke();
    }
    
    /* --- ANALOG KLOCKA --- */
    function drawClock() {
      const canvas = document.getElementById("clock-canvas");
      const ctx = canvas.getContext("2d");
      const x = canvas.width / 2;
      const y = canvas.height / 2;
      const radius = Math.min(x, y) * 0.90;
      
      const rootStyles = getComputedStyle(document.documentElement);
      const clockBg = rootStyles.getPropertyValue('--clock-bg').trim();
      const clockBorder = rootStyles.getPropertyValue('--clock-border').trim();
      const clockBorderWidth = parseFloat(rootStyles.getPropertyValue('--clock-border-width')) || 0.05;
      const clockDigit = rootStyles.getPropertyValue('--clock-digit').trim();
      const clockHand = rootStyles.getPropertyValue('--clock-hand').trim();
      const clockSecondHand = rootStyles.getPropertyValue('--clock-second-hand').trim();
      
      ctx.clearRect(0, 0, canvas.width, canvas.height);
      
      ctx.beginPath();
      ctx.arc(x, y, radius, 0, 2 * Math.PI);
      ctx.fillStyle = clockBg;
      ctx.fill();
      ctx.strokeStyle = clockBorder;
      ctx.lineWidth = radius * clockBorderWidth;
      ctx.stroke();
      
      ctx.fillStyle = clockDigit;
      ctx.font = (radius * 0.15) + "px sans-serif";
      ctx.textBaseline = "middle";
      ctx.textAlign = "center";
      for (let num = 1; num <= 12; num++) {
        let ang = num * Math.PI / 6;
        let numX = x + radius * 0.75 * Math.cos(ang - Math.PI/2);
        let numY = y + radius * 0.75 * Math.sin(ang - Math.PI/2);
        ctx.fillText(num.toString(), numX, numY);
      }
      
      let now = new Date();
      let hour = now.getHours();
      let minute = now.getMinutes();
      let second = now.getSeconds();
      hour = hour % 12;
      let hourAngle = (hour * Math.PI / 6) + (minute * Math.PI / 360) + (second * Math.PI / 21600);
      drawHand(ctx, x, y, hourAngle, radius * 0.5, radius * 0.07, clockHand);
      let minuteAngle = (minute * Math.PI / 30) + (second * Math.PI / 1800);
      drawHand(ctx, x, y, minuteAngle, radius * 0.7, radius * 0.05, clockHand);
      let secondAngle = second * Math.PI / 30;
      drawHand(ctx, x, y, secondAngle, radius * 0.8, radius * 0.02, clockSecondHand);
    }
    
    function drawHand(ctx, x, y, pos, length, width, color) {
      ctx.beginPath();
      ctx.lineWidth = width;
      ctx.lineCap = "round";
      ctx.strokeStyle = color ? color : "#40534C";
      ctx.moveTo(x, y);
      ctx.lineTo(x + length * Math.cos(pos - Math.PI/2), y + length * Math.sin(pos - Math.PI/2));
      ctx.stroke();
    }
    
    setInterval(drawClock, 1000);
    drawClock();
    
    document.getElementById("add-info-btn").addEventListener("click", function() {
      const infoContainer = document.getElementById("info-container");
      const newInfo = document.createElement("div");
      newInfo.className = "inforuta";
      newInfo.contentEditable = "true";
      newInfo.textContent = "Skriv här...";
      infoContainer.appendChild(newInfo);
    });
  </script>
</body>
</html>
